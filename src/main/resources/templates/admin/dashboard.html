<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title>admin</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/myrest.css}" />
    <link rel="stylesheet" href="/css/HeaderFooter.css" />
    <link rel="stylesheet" href="/css/common.css" />
    <link rel="stylesheet" href="/css/dashboard.css" />
    <script>
      function confirmDelete() {
        // 사용자에게 경고창을 띄워 확인 여부를 물어봅니다.
        var confirmDelete = confirm("정말로 회원삭제 하시겠습니까?");

        // 사용자가 확인을 선택한 경우에만 양식을 제출합니다.
        return confirmDelete;
      }
    </script>
  </head>
  <body>
    <header th:replace="~{/header :: header}"></header>
    <br />
    <br />

    <p class="admin-title">관리자페이지</p>

    <!--    <span th:if="${user}" th:text="|${user.autho}-${user.nickname} 관리자님 환영합니다.|">아이디 존재</span><br/>
   <span th:unless="${user}">아이디 비존재</span><br/>
 -->
    <div class="userinfo_box">
      <h1 class="userinfo_title">유저리스트</h1>
      <div class="userinfo">
        <ul class="dash_ul">
          <li>회원번호</li>
          <li>회원 아이디</li>
          <li>회원 닉네임</li>
          <li>회원 이메일</li>
          <li>가입날짜</li>
          <li></li>
        </ul>
        <!-- 유저 리스트 반복 -->
        <ul th:each="user : ${users}" class="dash_u2">
          <li th:text="${user.id}">회원번호</li>
          <li th:text="${user.username}">회원 아이디</li>
          <li th:text="${user.nickname}">회원 닉네임</li>
          <li th:text="${user.email}">회원 이메일</li>
          <li
            th:text="${#dates.format(user.createdDate, 'yyyy-MM-dd HH:mm:ss')}"
          >
            가입날짜
          </li>
          <li>
            <form
              th:if="${user.id gt 100} "
              th:action="@{/admin/delete_user}"
              method="post"
            >
              <input type="hidden" th:name="id" th:value="${user.id}" />
              <button type="submit" onclick="return confirmDelete();">
                회원삭제
              </button>
            </form>
          </li>
        </ul>
      </div>

      <div class="dash_grid">
        <h1 class="commu_title">커뮤니티 글 리스트</h1>
        <div class="commu_list">
          <ul class="commu_ul">
            <li>글번호</li>
            <li></li>
            <li>제목</li>
            <li>작성자</li>
            <li>작성날짜</li>
            <li>페이지</li>
            <li>글삭제</li>
          </ul>
          <ul class="commu_ul2" th:each="community : ${communities}">
            <li th:text="${community.id}"></li>
            <li th:text="${community.category}"></li>
            <li>
              <a
                th:href="@{|/talk.yalolza.gg/community/detail/${community.id}|}"
                th:if="${#strings.length(community.title) <= 7}"
                th:text="${community.title}"
              ></a>
              <a
                th:href="@{|/talk.yalolza.gg/community/detail/${community.id}|}"
                th:if="${#strings.length(community.title) > 7}"
                th:text="${community.title.substring(0, 15)} + '...'"
              ></a>
            </li>
            <li th:text="${community.siteUser.nickname}"></li>
            <li
              th:text="${#temporals.format(community.createDate, 'yyyy-MM-dd')}"
            ></li>
            <li>
              <!-- 게시글 클릭 링크 - 새 창으로 열기 -->
              <a
                th:href="@{/talk.yalolza.gg/community/detail/{id}(id=${community.id})}"
                target="_blank"
                >게시글</a
              >
            </li>
            <li>
              <form th:action="@{/admin/delete_community}" method="post">
                <input type="hidden" name="id" th:value="${community.id}" />
                <button type="submit" class="delete">삭제</button>
              </form>
            </li>
          </ul>
        </div>
        <h1 class="comment_title">댓글 리스트</h1>
        <div class="comment_list">
          <ul class="comment_ul">
            <li>댓글번호</li>
            <li>댓글내용</li>
            <li>작성자</li>
            <li>작성날짜</li>
            <li>페이지</li>
            <li>댓글삭제</li>
          </ul>
          <ul th:each="comment : ${comments}">
            <li th:text="${comment.id}"></li>
            <li>
              <a
                th:href="@{|/talk.yalolza.gg/community/detail/${comment.community.id}|}"
                th:if="${#strings.length(comment.content) <= 15}"
                th:text="${comment.content}"
              ></a>
              <a
                th:href="@{|/talk.yalolza.gg/community/detail/${comment.community.id}|}"
                th:if="${#strings.length(comment.content) > 15}"
                th:text="${comment.content.substring(0, 15)} + '...'"
              ></a>
            </li>
            <li th:text="${comment.author.nickname}"></li>
            <li
              th:text="${#temporals.format(comment.createDate, 'yyyy-MM-dd')}"
            ></li>
            <li>
              <!-- 게시글 클릭 링크 - 새 창으로 열기 -->
              <a
                th:href="@{/talk.yalolza.gg/community/detail/{id}(id=${comment.community.id})}"
                target="_blank"
                >댓글</a
              >
            </li>
            <li>
              <form th:action="@{/admin/delete_comment}" method="post">
                <input type="hidden" name="id" th:value="${comment.id}" />
                <button type="submit" class="delete">삭제</button>
              </form>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <footer th:replace="~{/footer :: footer}"></footer>
  </body>
</html>
